(this["webpackJsonptransposable-elements-app"]=this["webpackJsonptransposable-elements-app"]||[]).push([[0],{36:function(e,t){},50:function(e,t){},63:function(e,t,s){},92:function(e,t,s){"use strict";s.r(t);var a=s(18),n=s.n(a),r=s(47),i=s.n(r),l=(s(63),s.p,s(3)),c=s(4),o=s(12),h=s(13),d=s(48),m=s(49),u=s(54),b=s(8),j=[{name:"chr1",order:1,length:248956422,cumPos:0},{name:"chr2",order:2,length:242193529,cumPos:248956422},{name:"chr3",order:3,length:198295559,cumPos:491149951},{name:"chr4",order:4,length:190214555,cumPos:689445510},{name:"chr5",order:5,length:181538259,cumPos:879660065},{name:"chr6",order:6,length:170805979,cumPos:1061198324},{name:"chr7",order:7,length:159345973,cumPos:1232004303},{name:"chr8",order:8,length:145138636,cumPos:1391350276},{name:"chr9",order:9,length:138394717,cumPos:1536488912},{name:"chr10",order:10,length:133797422,cumPos:1674883629},{name:"chr11",order:11,length:135086622,cumPos:1808681051},{name:"chr12",order:12,length:133275309,cumPos:1943767673},{name:"chr13",order:13,length:114364328,cumPos:2077042982},{name:"chr14",order:14,length:107043718,cumPos:2191407310},{name:"chr15",order:15,length:101991189,cumPos:2298451028},{name:"chr16",order:16,length:90338345,cumPos:2400442217},{name:"chr17",order:17,length:83257441,cumPos:2490780562},{name:"chr18",order:18,length:80373285,cumPos:2574038003},{name:"chr19",order:19,length:58617616,cumPos:2654411288},{name:"chr20",order:20,length:64444167,cumPos:2713028904},{name:"chr21",order:21,length:46709983,cumPos:2777473071},{name:"chr22",order:22,length:50818468,cumPos:2824183054},{name:"chrX",order:23,length:156040895,cumPos:2875001522},{name:"chrY",order:24,length:57227415,cumPos:3031042417}],g=function(e,t){return j.filter((function(t){return t.name===e}))[0].cumPos+t},f=s(94),p=s(53),v=s.n(p),x=function(e){var t=j.map((function(e){return e.name}));if(e.includes(":")){var s=e.split(":").filter((function(e){return e}));if(1===s.length&&t.includes(s[0])){var a=s[0];return{posAbs:g(a,0)}}if(s.length>1&&t.includes(s[0])&&parseInt(s[1],10)){var n=s[0],r=parseInt(s[1],10);return{posAbs:g(n,r)}}}else if(t.includes(e))return{posAbs:g(e,0)};return null},O=s(1),P=50,N=function(e){Object(o.a)(s,e);var t=Object(h.a)(s);function s(e){var a;return Object(l.a)(this,s),(a=t.call(this,e)).state={showFilter:!1,loading:!0,variants:[],displayedVariants:[],tablePage:0,filter:{}},a.variants=[],a.loadingVariantsCalled=!1,a}return Object(c.a)(s,[{key:"componentDidMount",value:function(){this.nextPage=this.nextPage.bind(this),this.previousPage=this.previousPage.bind(this),this.toggleFilter=this.toggleFilter.bind(this),this.filterChange=this.filterChange.bind(this),this.toggleDetails=this.toggleDetails.bind(this),this.loadVariants()}},{key:"nextPage",value:function(){this.setState((function(e){return{tablePage:e.tablePage+1}}))}},{key:"previousPage",value:function(){this.setState((function(e){return{tablePage:e.tablePage-1}}))}},{key:"toggleFilter",value:function(){this.setState((function(e){return{showFilter:!e.showFilter}}))}},{key:"toggleDetails",value:function(e){e.preventDefault();var t=e.target.dataset.id,s=this.state.displayedVariants;s.forEach((function(e){e.id===t&&(e.showDetails=!e.showDetails)})),this.setState((function(e){return{displayedVariants:s}}))}},{key:"filterChange",value:function(e){var t=e.target.dataset.filtertype,s=this.state.filter;s[t]=e.target.value,""==e.target.value&&delete s[t],this.applyFilter(s)}},{key:"applyFilter",value:function(e){var t=this.state.variants;if(void 0!==e.id&&(t=t.filter((function(t){return t.id.includes(e.id)}))),void 0!==e.from){var s=x(e.from);s&&(t=t.filter((function(e){return e.posAbs>=s.posAbs})))}if(void 0!==e.to){var a=x(e.to);a&&(t=t.filter((function(e){return e.posAbs<=a.posAbs})))}this.setState((function(s){return{filter:e,displayedVariants:t}}))}},{key:"loadVariants",value:function(){var e=this;this.loadingVariantsCalled||(this.loadingVariantsCalled=!0,this.vcfFile=new m.a({filehandle:new b.b("https://aveit.s3.amazonaws.com/misc/sva_elements.sorted.vcf.gz"),tbiFilehandle:new b.b("https://aveit.s3.amazonaws.com/misc/sva_elements.sorted.vcf.gz.tbi")}),this.vcfFile.getHeader().then((function(t){var s=new u.a({header:t}),a=[];j.forEach((function(t){var n=e.vcfFile.getLines(t.name,0,t.length,(function(a){var n=s.parseLine(a);e.variants.push(function(e,t){var s=e.INFO,a=1e9*t.order+e.POS;return{id:v()(a).substring(0,4),order:a,chrom:e.CHROM,chromOrder:t.order,start:e.POS,end:s.END[0],length:s.SVLEN[0],type:s.SVTYPE[0],info:s,posAbs:g(e.CHROM,+e.POS),showDetails:!1}}(n,t))}));a.push(n)})),Promise.all(a).then((function(t){e.setState((function(t){return{loading:!1,variants:e.variants,displayedVariants:e.variants}}))}))})))}},{key:"render",value:function(){var e=this;if(this.state.loading)return Object(O.jsxs)("div",{className:"text-center",children:[Object(O.jsx)(d.a,{color:"#999999",width:"50px",height:"50px"}),Object(O.jsx)("div",{className:"mt-2 small text-muted",children:"Loading variants..."})]});var t=[],s=this.state.displayedVariants.sort((function(e,t){return e.order-t.order}));s.slice(this.state.tablePage*P,(this.state.tablePage+1)*P).forEach((function(s,a){if(t.push(Object(O.jsxs)("tr",{className:s.showDetails?"table-secondary":"",children:[Object(O.jsx)("td",{children:s.id}),Object(O.jsx)("td",{children:s.chrom}),Object(O.jsx)("td",{children:Object(f.a)(",.0f")(s.start)}),Object(O.jsx)("td",{children:Object(f.a)(",.0f")(s.end)}),Object(O.jsx)("td",{children:s.length}),Object(O.jsx)("td",{children:s.type}),Object(O.jsx)("td",{children:Object(O.jsx)("a",{href:"#",className:"link-primary","data-id":s.id,onClick:e.toggleDetails,children:"Details"})})]})),s.showDetails){var n=[];for(var r in s.info)n.push(Object(O.jsxs)("div",{className:"col-md-4",children:[Object(O.jsxs)("strong",{children:[r,":"]})," ",s.info[r]]}));t.push(Object(O.jsx)("tr",{className:"table-light",children:Object(O.jsx)("td",{colSpan:7,children:Object(O.jsx)("div",{className:"row",children:n})})}))}}));var a=[];this.state.tablePage>0&&a.push(Object(O.jsx)("button",{className:"btn btn-primary btn-sm mx-2",onClick:this.previousPage,children:"Previous"})),s.length>P&&(this.state.tablePage+1)*P<=s.length&&a.push(Object(O.jsx)("button",{className:"btn btn-primary btn-sm",onClick:this.nextPage,children:"Next"}));var n="No variants found";return s.length>0&&(n="Displaying variants ".concat(this.state.tablePage*P+1,"-").concat(Math.min((this.state.tablePage+1)*P,s.length)," of ").concat(s.length)),Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"d-flex mb-2",children:[Object(O.jsx)("div",{className:"me-auto"}),Object(O.jsx)("button",{className:"btn btn-primary me-auto btn-sm collapse",onClick:this.toggleFilter,children:"Filter"}),Object(O.jsx)("div",{className:"pt-1 mx-2",children:n}),a]}),Object(O.jsxs)("div",{className:"row pb-5",children:[Object(O.jsxs)("div",{className:"col-md-2",children:[Object(O.jsx)("div",{className:"small pt-1 text-muted",children:"FILTER"}),Object(O.jsxs)("div",{className:"mt-1 p-3 bg-light",children:[Object(O.jsxs)("div",{className:"mb-2",children:[Object(O.jsx)("label",{htmlFor:"filter-id",className:"form-label small",children:"ID"}),Object(O.jsx)("input",{className:"form-control form-control-sm",id:"filter-id","data-filtertype":"id",onChange:this.filterChange})]}),Object(O.jsxs)("div",{className:"mb-2",children:[Object(O.jsx)("label",{htmlFor:"filter-from",className:"form-label small",children:"From"}),Object(O.jsx)("input",{className:"form-control form-control-sm",id:"filter-from",placeholder:"e.g. chr1:1000000","data-filtertype":"from",onChange:this.filterChange})]}),Object(O.jsxs)("div",{className:"mb-2",children:[Object(O.jsx)("label",{htmlFor:"filter-to",className:"form-label small",children:"To"}),Object(O.jsx)("input",{className:"form-control form-control-sm",id:"filter-to",placeholder:"e.g. chr3:20000000","data-filtertype":"to",onChange:this.filterChange})]})]})]}),Object(O.jsx)("div",{className:"col-md-10",children:Object(O.jsxs)("table",{className:"table table-hover table-sm",children:[Object(O.jsx)("thead",{className:"sticky-table-header bg-white",children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{scope:"col",children:"ID"}),Object(O.jsx)("th",{scope:"col",children:"Chomosome"}),Object(O.jsx)("th",{scope:"col",children:"Start"}),Object(O.jsx)("th",{scope:"col",children:"End"}),Object(O.jsx)("th",{scope:"col",children:"Length"}),Object(O.jsx)("th",{scope:"col",children:"SV type"}),Object(O.jsx)("th",{scope:"col"})]})}),Object(O.jsx)("tbody",{children:t})]})})]})]})}}]),s}(n.a.Component);s(91);var y=function(){return Object(O.jsxs)("div",{className:"container",children:[Object(O.jsx)("h1",{className:"py-4",children:"Variants"}),Object(O.jsx)(N,{})]})},F=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,95)).then((function(t){var s=t.getCLS,a=t.getFID,n=t.getFCP,r=t.getLCP,i=t.getTTFB;s(e),a(e),n(e),r(e),i(e)}))};i.a.createRoot(document.getElementById("root")).render(Object(O.jsx)(n.a.StrictMode,{children:Object(O.jsx)(y,{})})),F()}},[[92,1,2]]]);
//# sourceMappingURL=main.b1a90b41.chunk.js.map